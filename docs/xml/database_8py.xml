<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.14.0" xml:lang="zh">
  <compounddef id="database_8py" kind="file" language="Python">
    <compoundname>database.py</compoundname>
    <innerclass refid="classapp_1_1database_1_1_user" prot="public">app::database::User</innerclass>
    <innerclass refid="classapp_1_1database_1_1_conference" prot="public">app::database::Conference</innerclass>
    <innerclass refid="classapp_1_1database_1_1_agenda_item" prot="public">app::database::AgendaItem</innerclass>
    <innerclass refid="classapp_1_1database_1_1_registration" prot="public">app::database::Registration</innerclass>
    <innerclass refid="classapp_1_1database_1_1_friendship_status" prot="public">app::database::FriendshipStatus</innerclass>
    <innerclass refid="classapp_1_1database_1_1_notification_type" prot="public">app::database::NotificationType</innerclass>
    <innerclass refid="classapp_1_1database_1_1_friendship" prot="public">app::database::Friendship</innerclass>
    <innerclass refid="classapp_1_1database_1_1_notification" prot="public">app::database::Notification</innerclass>
    <innernamespace refid="namespaceapp">app</innernamespace>
    <innernamespace refid="namespaceapp_1_1database">app::database</innernamespace>
    <briefdescription>
<para>数据库模型和配置模块 </para>
    </briefdescription>
    <detaileddescription>
<para>定义了所有数据库模型、枚举类型和数据库连接配置 <simplesect kind="author"><para>Meeting System Team </para>
</simplesect>
<simplesect kind="date"><para>2024 </para>
</simplesect>
<simplesect kind="version"><para>1.0 </para>
</simplesect>
</para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sqlalchemy<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>create_engine,<sp/>Column,<sp/>Integer,<sp/>String,<sp/>Boolean,<sp/>DateTime,<sp/>ForeignKey,<sp/>Text,<sp/>Enum</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sqlalchemy.ext.declarative<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>declarative_base</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sqlalchemy.orm<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sessionmaker,<sp/>relationship</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>datetime<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>datetime</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>enum<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Enum<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>PyEnum</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespaceapp_1_1config" kindref="compound">app.config</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>settings</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal">engine<sp/>=<sp/>create_engine(</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>settings.DATABASE_URL,<sp/>connect_args={</highlight><highlight class="stringliteral">&quot;check_same_thread&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">#<sp/>SQLite特有的参数，允许多线程访问</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal">)</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal">SessionLocal<sp/>=<sp/>sessionmaker(autocommit=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>autoflush=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>bind=engine)</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal">Base<sp/>=<sp/>declarative_base()</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">get_db():</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>db<sp/>=<sp/>SessionLocal()</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>db<sp/><sp/></highlight><highlight class="comment">#<sp/>返回数据库会话</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">finally</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db.close()<sp/><sp/></highlight><highlight class="comment">#<sp/>确保会话被关闭</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="classapp_1_1database_1_1_user" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_user" kindref="compound">User</ref>(Base):</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;users&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>用户ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>username<sp/>=<sp/>Column(String,<sp/>unique=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>用户名，唯一</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>email<sp/>=<sp/>Column(String,<sp/>unique=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>电子邮箱，唯一</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>hashed_password<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>哈希后的密码</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>is_admin<sp/>=<sp/>Column(Boolean,<sp/>default=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>是否为管理员</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>created_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>创建时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>conferences<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Conference&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;creator&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>用户创建的会议</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>registrations<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Registration&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>用户参加的会议</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>sent_friendships<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Friendship&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=</highlight><highlight class="stringliteral">&quot;Friendship.user_id&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>发起的好友关系</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>received_friendships<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Friendship&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=</highlight><highlight class="stringliteral">&quot;Friendship.friend_id&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;friend&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>接收的好友关系</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>notifications<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Notification&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=</highlight><highlight class="stringliteral">&quot;Notification.user_id&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>用户的通知</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="classapp_1_1database_1_1_conference" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_conference" kindref="compound">Conference</ref>(Base):</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;conferences&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>title<sp/>=<sp/>Column(String,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议标题</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/>description<sp/>=<sp/>Column(Text)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议描述</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>date<sp/>=<sp/>Column(DateTime)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议日期</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/>location<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议地点</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>created_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>创建时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>creator_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>创建者ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>creator<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;conferences&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议创建者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/>agenda_items<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;AgendaItem&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;conference&quot;</highlight><highlight class="normal">,<sp/>cascade=</highlight><highlight class="stringliteral">&quot;all,<sp/>delete-orphan&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议议程项</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>registrations<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Registration&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;conference&quot;</highlight><highlight class="normal">,<sp/>cascade=</highlight><highlight class="stringliteral">&quot;all,<sp/>delete-orphan&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>会议参与者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98" refid="classapp_1_1database_1_1_agenda_item" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_agenda_item" kindref="compound">AgendaItem</ref>(Base):</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;会议议程项模型&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;agenda_items&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>数据库表名</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>议程项ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>conference_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;conferences.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>所属会议ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>start_time<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>开始时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>end_time<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>结束时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>title<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>议程标题</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>speaker<sp/>=<sp/>Column(String)<sp/><sp/></highlight><highlight class="comment">#<sp/>演讲者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>created_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>创建时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>conference<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Conference&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;agenda_items&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>所属会议</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classapp_1_1database_1_1_registration" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_registration" kindref="compound">Registration</ref>(Base):</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;会议注册模型（用户参加会议的记录）&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;registrations&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>数据库表名</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>注册ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>user_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>用户ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>conference_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;conferences.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>会议ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>registered_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>注册时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>user<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;registrations&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>参会用户</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>conference<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;Conference&quot;</highlight><highlight class="normal">,<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;registrations&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>参加的会议</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="135" refid="classapp_1_1database_1_1_friendship_status" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_friendship_status" kindref="compound">FriendshipStatus</ref>(PyEnum):</highlight></codeline>
<codeline lineno="136" refid="classapp_1_1database_1_1_friendship_status_1a87c627095e471324096a89595731426d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>PENDING<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;pending&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="137" refid="classapp_1_1database_1_1_friendship_status_1a04942b653032c597091b10f6797bf87c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>ACCEPTED<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;accepted&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="138" refid="classapp_1_1database_1_1_friendship_status_1ab1fd80afb464a34041b5a091960192a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>REJECTED<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;rejected&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="146" refid="classapp_1_1database_1_1_notification_type" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_notification_type" kindref="compound">NotificationType</ref>(PyEnum):</highlight></codeline>
<codeline lineno="147" refid="classapp_1_1database_1_1_notification_type_1ade818ef934cfa170767d081b9e85bde0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>FRIEND_REQUEST<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;friend_request&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="148" refid="classapp_1_1database_1_1_notification_type_1a30ae7600d2a88d4e3401c8b0f698e443" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>FRIEND_ACCEPTED<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;friend_accepted&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="149" refid="classapp_1_1database_1_1_notification_type_1ab4d982dc2bf494df0feb2f40b6fcbc2e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>MEETING_INVITATION<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;meeting_invitation&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="150" refid="classapp_1_1database_1_1_notification_type_1abd4485cccc9954f9e822d7421e4e4da2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>MEETING_JOINED<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;meeting_joined&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="151" refid="classapp_1_1database_1_1_notification_type_1aa5c36c33f9e413133be349f2b4f87a0a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>MEETING_LEFT<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;meeting_left&quot;</highlight><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="comment">#<sp/>好友关系模型</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155" refid="classapp_1_1database_1_1_friendship" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_friendship" kindref="compound">Friendship</ref>(Base):</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;好友关系模型&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;friendships&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>数据库表名</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>关系ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>user_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>发起者ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>friend_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>接收者ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/>Column(Enum(FriendshipStatus),<sp/>default=FriendshipStatus.PENDING)<sp/><sp/></highlight><highlight class="comment">#<sp/>关系状态</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>created_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>创建时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>updated_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow,<sp/>onupdate=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>更新时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>user<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=[user_id],<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;sent_friendships&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>发起者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>friend<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=[friend_id],<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;received_friendships&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>接收者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="comment">#<sp/>通知模型</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173" refid="classapp_1_1database_1_1_notification" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classapp_1_1database_1_1_notification" kindref="compound">Notification</ref>(Base):</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;通知模型&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>__tablename__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;notifications&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>数据库表名</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>基本字段</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>id<sp/>=<sp/>Column(Integer,<sp/>primary_key=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>通知ID，主键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>user_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">))<sp/><sp/></highlight><highlight class="comment">#<sp/>接收者ID，外键</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>sender_id<sp/>=<sp/>Column(Integer,<sp/>ForeignKey(</highlight><highlight class="stringliteral">&quot;users.id&quot;</highlight><highlight class="normal">),<sp/>nullable=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>发送者ID，外键，可为空</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>type<sp/>=<sp/>Column(Enum(NotificationType))<sp/><sp/></highlight><highlight class="comment">#<sp/>通知类型</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>content<sp/>=<sp/>Column(Text)<sp/><sp/></highlight><highlight class="comment">#<sp/>通知内容</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>is_read<sp/>=<sp/>Column(Boolean,<sp/>default=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>是否已读</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>related_id<sp/>=<sp/>Column(Integer,<sp/>nullable=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>相关ID，如会议ID或好友关系ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>created_at<sp/>=<sp/>Column(DateTime,<sp/>default=datetime.utcnow)<sp/><sp/></highlight><highlight class="comment">#<sp/>创建时间</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>关系定义</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>user<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=[user_id],<sp/>back_populates=</highlight><highlight class="stringliteral">&quot;notifications&quot;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>接收者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>sender<sp/>=<sp/>relationship(</highlight><highlight class="stringliteral">&quot;User&quot;</highlight><highlight class="normal">,<sp/>foreign_keys=[sender_id])<sp/><sp/></highlight><highlight class="comment">#<sp/>发送者</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">create_tables():</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>Base.metadata.create_all(bind=engine)<sp/><sp/></highlight><highlight class="comment">#<sp/>使用SQLAlchemy创建所有定义的表</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="app/database.py"/>
  </compounddef>
</doxygen>
