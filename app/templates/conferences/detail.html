{% extends "base.html" %}

{% block title %}{{ conference.title }} - ä¼šè®®ç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block content %}
<div class="page-transition">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">é¦–é¡µ</a></li>
            <li class="breadcrumb-item"><a href="/api/conferences/">ä¼šè®®åˆ—è¡¨</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ conference.title }}</li>
        </ol>
    </nav>

    <div class="card">
        <div class="card-header">
            <h1>{{ conference.title }}</h1>
        </div>
        <div class="card-body conference-details">
            <div class="conference-meta">
                <div class="conference-meta-item">
                    <i class="fa fa-calendar"></i>
                    <strong>æ—¥æœŸ:</strong> {{ conference.date.strftime('%Y-%m-%d %H:%M') }}
                </div>
                <div class="conference-meta-item">
                    <i class="fa fa-map-marker"></i>
                    <strong>åœ°ç‚¹:</strong> {{ conference.location }}
                </div>
                <div class="conference-meta-item">
                    <i class="fa fa-user"></i>
                    <strong>ç»„ç»‡è€…:</strong> {{ conference.creator.username }}
                </div>
                {% if is_registered %}
                    <div class="conference-meta-item">
                        <span class="badge badge-success">å·²å‚åŠ </span>
                    </div>
                {% endif %}
            </div>

            <h3>ä¼šè®®æè¿°</h3>
            <div class="card mb-4">
                <div class="card-body">
                    <p>{{ conference.description }}</p>
                </div>
            </div>

            <div class="action-buttons">
                {% if current_user %}
                    {% if is_registered %}
                        <a href="/api/registrations/unregister/{{ conference.id }}" class="btn btn-danger delete-btn" data-confirm-message="ç¡®å®šè¦é€€å‡ºæ­¤ä¼šè®®å—ï¼Ÿ">
                            <i class="fa fa-times"></i> é€€å‡ºä¼šè®®
                        </a>
                    {% else %}
                        <a href="/api/registrations/register/{{ conference.id }}" class="btn btn-success">
                            <i class="fa fa-check"></i> å‚åŠ æ­¤ä¼šè®®
                        </a>
                    {% endif %}
                {% else %}
                    <div class="alert alert-info">
                        è¯·<a href="/api/auth/login">ç™»å½•</a>åå‚åŠ æ­¤ä¼šè®®ã€‚
                    </div>
                {% endif %}

                {% if current_user and current_user.id == conference.creator_id %}
                    <div class="mt-3 admin-actions">
                        <a href="/api/conferences/{{ conference.id }}/edit" class="btn btn-primary">
                            <i class="fa fa-edit"></i> ç¼–è¾‘ä¼šè®®
                        </a>
                        <a href="/api/registrations/attendees/{{ conference.id }}" class="btn btn-info">
                            <i class="fa fa-users"></i> æŸ¥çœ‹å‚ä¼šè€…
                        </a>
                        <a href="/api/conferences/{{ conference.id }}/delete" class="btn btn-danger delete-btn" data-confirm-message="ç¡®å®šè¦åˆ é™¤æ­¤ä¼šè®®å—ï¼Ÿ">
                            <i class="fa fa-trash"></i> åˆ é™¤ä¼šè®®
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card mt-4 page-transition" style="animation-delay: 0.2s;">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h2>ä¼šè®®è®®ç¨‹</h2>
        <span class="badge badge-primary">{{ agenda_items|length }} ä¸ªè®®ç¨‹é¡¹ç›®</span>
    </div>
    <div class="card-body">
        {% if agenda_items %}
            <div class="agenda-timeline">
                {% for item in agenda_items %}
                    <div class="agenda-item-timeline">
                        <div class="agenda-time">{{ item.start_time }} - {{ item.end_time }}</div>
                        <h4>{{ item.title }}</h4>
                        <div class="speaker">
                            <i class="fa fa-user"></i> {{ item.speaker }}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-4">
                <p>æ­¤ä¼šè®®æš‚æ— è®®ç¨‹é¡¹ç›®ã€‚</p>
                {% if current_user and current_user.id == conference.creator_id %}
                    <a href="/api/conferences/{{ conference.id }}/edit" class="btn btn-primary">
                        æ·»åŠ è®®ç¨‹é¡¹ç›®
                    </a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Add font awesome icons
    document.addEventListener('DOMContentLoaded', function() {
        // Simulate font awesome icons since we don't have the actual library
        const iconElements = document.querySelectorAll('.fa');
        iconElements.forEach(icon => {
            if (icon.classList.contains('fa-calendar')) {
                icon.textContent = 'ğŸ“… ';
            } else if (icon.classList.contains('fa-map-marker')) {
                icon.textContent = 'ğŸ“ ';
            } else if (icon.classList.contains('fa-user')) {
                icon.textContent = 'ğŸ‘¤ ';
            } else if (icon.classList.contains('fa-users')) {
                icon.textContent = 'ğŸ‘¥ ';
            } else if (icon.classList.contains('fa-edit')) {
                icon.textContent = 'âœï¸ ';
            } else if (icon.classList.contains('fa-trash')) {
                icon.textContent = 'ğŸ—‘ï¸ ';
            } else if (icon.classList.contains('fa-check')) {
                icon.textContent = 'âœ… ';
            } else if (icon.classList.contains('fa-times')) {
                icon.textContent = 'âŒ ';
            }
        });

        // Add breadcrumb styles
        const breadcrumb = document.querySelector('.breadcrumb');
        if (breadcrumb) {
            breadcrumb.style.display = 'flex';
            breadcrumb.style.listStyle = 'none';
            breadcrumb.style.padding = '0.75rem 1rem';
            breadcrumb.style.backgroundColor = '#f8f9fa';
            breadcrumb.style.borderRadius = '0.25rem';
            breadcrumb.style.marginBottom = '1rem';

            const items = breadcrumb.querySelectorAll('.breadcrumb-item');
            items.forEach(item => {
                item.style.marginRight = '0.5rem';

                if (item.classList.contains('active')) {
                    item.style.color = '#6c757d';
                }
            });

            const links = breadcrumb.querySelectorAll('a');
            links.forEach(link => {
                link.style.color = '#007bff';
                link.style.textDecoration = 'none';
            });
        }
    });
</script>
{% endblock %}
